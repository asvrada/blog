{"componentChunkName":"component---src-templates-blog-post-js","path":"/delete-qzone-feed/","result":{"data":{"site":{"siteMetadata":{"title":"Mindscape"}},"markdownRemark":{"id":"4054a4ed-8f63-5fa9-b68b-8feb47f65dc1","excerpt":"以下我使用Chrome浏览器进行演示。代码可能仅兼容该浏览器。进行操作的页面为QQ空间 > 个人中心 > 说说。  1. 了解大致流程 首先需要知道人工删除一条说说该怎么做。人工的话操作起来很简单，说说下方有删除按钮，点击后会出现确认对话框，点击确认即可。  接下来，观察QQ…","html":"<p>以下我使用Chrome浏览器进行演示。代码可能仅兼容该浏览器。进行操作的页面为<em>QQ空间 > 个人中心 > 说说</em>。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/7fe0f1cd1002d5792fa1b151cfdfecd8/b2982/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.54054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/klEQVQozzWQTU8TURSG58fIVIMJOyFRCKEQ2ejWnQsxka0bVi4UiJGVO38BxjVxQUqMGDSkNUZFsJ+mnbYz05m2MF+dr3bSxzsTvcmb95x773numyvlcjmuyzM8uHeT9fVV8vk8N3Iy12ZmkIWn/a35edaWlri7vMz8wgKrq2vMzc2xspJndnYWWZZJObKcQ6rVanwvNyj9vKBycU65UufV6zc83thgb28PRVFQVZVKtUpV3G00Gplq/+rU/6teqyIF0ZiqA2eqRzg0UDs6ugvTSUSSJOi6TrFYJF2TyQTf94miiDiOhceZpwrjMWYwRdItn4E9wvMcriwb13Ww7SsqgxDbE2d9k52d7SytbdsZ2HVdXMcRM25Wj4RbjkfdmiD17ADdDtGMPprapdPtYvYHjPxADIwIoiSDHBy8Z3Nzk/39fYbDS/wwzoKYTkDf8RkKXbk+0vlgjGpHGAKiCqCmqfRFqkrHQu+e41Z2GZZ301y82H7J7TuLnBS/0bkUMG9MT4TpOWLeCTHdEOm4B6fmFMW4RBP/pWkaTdOioER8bFqUWm3O2k1+KT1aHrw9/Mzi+n2ebD3ntO1ypnv81m1+aC5fOiOkE2PKpxRqJHw1E0rGhKJ44Fgd86ETU2gnHAkd/hlxpIS8K7V4+PQZj7a2KbQCsRdRaPrZWdr/BWfcFBN9sUNoAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Imgur\"\n        title=\"Imgur\"\n        src=\"/blog/static/7fe0f1cd1002d5792fa1b151cfdfecd8/fcda8/1.png\"\n        srcset=\"/blog/static/7fe0f1cd1002d5792fa1b151cfdfecd8/12f09/1.png 148w,\n/blog/static/7fe0f1cd1002d5792fa1b151cfdfecd8/e4a3f/1.png 295w,\n/blog/static/7fe0f1cd1002d5792fa1b151cfdfecd8/fcda8/1.png 590w,\n/blog/static/7fe0f1cd1002d5792fa1b151cfdfecd8/b2982/1.png 729w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>1. 了解大致流程</h2>\n<p>首先需要知道人工删除一条说说该怎么做。人工的话操作起来很简单，说说下方有删除按钮，点击后会出现确认对话框，点击确认即可。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/888a832f9eccb319384f329b0b84f2a1/772e8/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.56756756756756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAABzUlEQVQ4y51U207bQBDN/39HHxBSFYkKpJbSFomLqARVAqQ8hOYCKSE2Acde27vr8WFmHYdEoWrslUYzntGcnctZN1Dh5HmOLMtYE4jI2USZ04U/R8PaDKm2IP4oE7SxyEhscr4imWDYL3aSGth5TPziM8a4Sxutzh22Pl/i6NcAcWrR7U3w7bSLk4seTtpD+LMUZ+0BmgdXOG4NoVSC5tdrHPzsYvg4Q6fnO6AFoIpTeM8Kz7PE3ZYwaKhS+NMI0yCGsQSVGHj87U1DSEfjp9DlSKzsbAEo8+DpOCGZA5ePZR8VMyvtf81Wa10CFjeIFEFg3ZcvKnkJInz6fo3tL23cTUIXX5nhcvL/hRDHGje3Y3T+PCJQeg641PKmdJEjDHgvtjLDTQFL+ghlfnN1x8wCn5e21nIVQNdyonHa6mP3sIOHp6g+4MYtb7oQByjPjHk4YR6OJgE/hAKEqs6wPMQtp6nGj7MumvuXGHk1aSMJoq21K9xcllo8lCSlFKKIhXUcx0hYRNdaSs4zHD34+Lh3gQ875xj89fnJJQ681lKk5Zdghtv+GP17j+2Qq1Ou6sVbrkobw4lE1okx2gGJyGWVtlyCvv1AVuPlH/sVVF7QpQKvnlAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Imgur\"\n        title=\"Imgur\"\n        src=\"/blog/static/888a832f9eccb319384f329b0b84f2a1/772e8/2.png\"\n        srcset=\"/blog/static/888a832f9eccb319384f329b0b84f2a1/12f09/2.png 148w,\n/blog/static/888a832f9eccb319384f329b0b84f2a1/772e8/2.png 200w\"\n        sizes=\"(max-width: 200px) 100vw, 200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>接下来，观察QQ空间的网页结构来看如何用代码进行以上操作。</p>\n<p>通过检查页面工具，我们发现QQ空间的网页嵌套了一个<code class=\"language-text\">&lt;iframe&gt;</code>标签。而所有的说说，以及其删除按钮，都在这个<code class=\"language-text\">&lt;iframe&gt;</code>的根节点下。但是，确认对话框却在主根节点下。</p>\n<p>值得注意的是，<code class=\"language-text\">&lt;iframe&gt;</code>标签内的页面有其自己的document属性，直接在主界面的document下无法通过getElementByxxx找到<code class=\"language-text\">&lt;iframe&gt;</code>标签内的元素。解决方法便是提前获取到iframe的document:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> iframe_document <span class=\"token operator\">=</span> iframe<span class=\"token punctuation\">.</span>contentDocument<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// iframe_document.getElementById(xxx)...</span></code></pre></div>\n<h2>2.初步编写代码</h2>\n<p>代码应该进行以下操作：</p>\n<ol>\n<li>点击每个说说的“删除”按钮</li>\n<li>点击每个弹出来的对话框的“确认“按钮</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// 主页面的document</span>\n\t<span class=\"token keyword\">const</span> mainDocument <span class=\"token operator\">=</span> document<span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// 说说所在的iframe的document</span>\n\t<span class=\"token keyword\">const</span> feedDocument <span class=\"token operator\">=</span> mainDocument<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"app_canvas_frame\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>contentDocument<span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\">// 删除当前页面的所有说说</span>\n\t<span class=\"token keyword\">function</span> <span class=\"token function\">deleteFeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token comment\">// 获取删除说说的按钮</span>\n\t    <span class=\"token keyword\">let</span> listBtnDelete <span class=\"token operator\">=</span> feedDocument<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"del_btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> each <span class=\"token keyword\">of</span> listBtnDelete<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t        each<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token punctuation\">}</span>\n\t\n\t    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t        <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t            <span class=\"token comment\">// 弹出对话框的所有确认按钮</span>\n\t            <span class=\"token keyword\">let</span> listBtnConfirm <span class=\"token operator\">=</span> mainDocument<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"qz_dialog_layer_sub\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> each <span class=\"token keyword\">of</span> listBtnConfirm<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t                each<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t            <span class=\"token punctuation\">}</span>\n\t\n\t            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>3.运行</h2>\n<p>运行脚本的方法有很多种，这里就用最简单的。首先进入文章开头提到的说说页面，然后打开Chrome的开发者工具。找到Console（控制台）一栏，复制上面的代码到控制台最下方的输入区域，回车即可运行代码。</p>\n<hr>\n<p>测试代码的时候把自己的说说都删完了，目的达到了，我也懒得继续完善其他功能了。</p>\n<p>溜了溜了(ง ˙ω˙)ว 。</p>","frontmatter":{"title":"用脚本批量删除QQ空间的说说","date":"August 02, 2018","category":"code"}}},"pageContext":{"slug":"/delete-qzone-feed/"}}}